(this["webpackJsonpnoise-nodes"]=this["webpackJsonpnoise-nodes"]||[]).push([[0],{15:function(e,t,n){},18:function(e,t,n){e.exports=n(34)},23:function(e,t,n){},24:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(13),r=n.n(i),s=(n(23),n(2)),l=n(3),c=n(7),u=n(5),d=n(6),p=(n(15),n(24),n(8));function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).displayAbout=function(){n.setState({displaying:!n.state.displaying,aboutText:n.state.displaying?"About":"Made by Ian Fennie & Yannick Clausen"})},n.state={displaying:!1,aboutText:"About"},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e;return e=this.state.displaying?{fontSize:"10px",textAlign:"center",padding:"auto"}:{},o.a.createElement("header",{style:g},o.a.createElement("div",{style:f},o.a.createElement("h1",null,"NoiseNodes")),o.a.createElement("div",{style:m({},f,{},v,{},e),onClick:this.displayAbout},o.a.createElement("h1",null,this.state.aboutText)))}}]),t}(o.a.Component),g={position:"fixed",width:"100%",height:"75px",top:"0px",left:"0px",display:"flex",justifyContent:"space-between",alignItems:"center",background:"var(--primary-shade3)",border:"1px\xa0solid\xa0black",color:"white"},f={height:"75px",flexBasis:"250px",background:"var(--primary-shade4)",cursor:"default"},v={cursor:"pointer"};var b={width:"100%",position:"fixed",bottom:"0px",right:"0px",padding:"5px",background:"var(--primary-shade3)",textAlign:"right",fontSize:"10px",color:"white"},k=function(){return o.a.createElement("div",{style:b},"HAW Hamburg AVPRG W19")},E=n(11),C=n(4);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).toggleNodeHandlerDisplay=function(e){e.preventDefault(),n.setState({displaying:!n.state.displaying}),n.forceUpdate()},n.state={displaying:!1},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){for(var e=["OSC","GAIN","FILTER","LFO","ENV","SEQ","FM"],t=[],n=0;n<e.length;n++)t.push(o.a.createElement(N,{key:n,type:e[n],createNodeHandlers:this.props.createNodeHandlers}));return o.a.createElement("div",{style:S,onClick:this.toggleNodeHandlerDisplay},o.a.createElement("button",{style:w,onClick:this.toggleNodeHandlerDisplay},"+"),this.state.displaying?t:null)}}]),t}(o.a.Component),N=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={type:n.props.type},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("button",{onClick:this.props.createNodeHandlers[this.state.type],style:O({},w)},this.state.type)}}]),t}(o.a.Component),S={position:"fixed",top:"75px",display:"flex",flexGrow:"1",justifyContent:"space-around",background:"var(--primary-shade3)"},w={flexBasis:"55px",border:"none",padding:"8px 15px 6px",background:"var(--primary-shade2)",fontSize:"24px",fontWeight:"bold",color:"white",cursor:"pointer"},V=j,q=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).updatedSelectedState=function(){var e=n.isSelected();n.setState({selected:e}),e||clearInterval(n.timerID)},n.handleClick=function(e){var t=n.props,a=t.id,o=t.type,i=t.audioNode;n.props.select(a,o,i),n.setState((function(e,t){return{selected:n.isSelected(),selection:n.props.getSelection()}})),setInterval(n.updatedSelectedState,100)},n.getColors=function(){return RegExp("audio-.*").test(n.props.type)?{stroke:"var(--secondary1-shade1)",strokeActive:"var(--secondary1-shade3)",fill:"var(--secondary1-shade0)",fillActive:"var(--secondary1-shade1)"}:RegExp("control-.*").test(n.props.type)?{stroke:"var(--secondary2-shade1)",strokeActive:"var(--secondary2-shade3)",fill:"var(--secondary2-shade0)",fillActive:"var(--secondary2-shade1)"}:void 0},n.isInput=function(){return RegExp(".-input").test(n.props.type)},n.getTranslation=function(e,t,a){return n.isInput()?"translate(x y)".replace("x",2*(-t+a)).replace("y",-20):"translate(x y)".replace("x",a/3).replace("y",-20)},n.isSelected=function(){var e=n.props.getSelection();if(void 0!=typeof e){var t=!0,a=!1,o=void 0;try{for(var i,r=e.filter((function(e){return null!==e}))[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=i.value;return n.props.id===s.id&&n.props.audioNode===s.audioNode}}catch(l){a=!0,o=l}finally{try{t||null==r.return||r.return()}finally{if(a)throw o}}}},n.state={selected:!1,selection:[null,null]},n.vis={height:50,width:50,dim:16,colors:n.getColors(),isInput:n.isInput(),transformToInputPosition:"translate(x y)".replace("x",n.props.coordinates.x).replace("y",n.props.coordinates.y)},n.vis.strokeWidth=n.vis.dim/3*2,n.vis.boundary=n.vis.dim+n.vis.strokeWidth,n.timerID=null,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.getColors(),t=this.isInput();return o.a.createElement("svg",{className:this.props.id,height:65,width:50,style:{cursor:"pointer",position:"relative",left:this.props.coordinates.x,top:this.props.coordinates.y}},o.a.createElement("circle",{cx:t?16+16/3*2:50-(16+16/3*2),cy:16+16/3*2,r:16,stroke:this.state.selected?e.strokeActive:e.stroke,strokeWidth:16/3*2,fill:this.state.selected?e.fillActive:e.fill,onClick:this.handleClick}))}}]),t}(o.a.Component),P=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"changeValue",value:function(e,t,n){var a=this,o=e,i=this.state[n.tag];i.relValue=o,this.setState(Object(p.a)({},n.tag,i),(function(){t.linearRampToValueAtTime(a.state[n.tag].absValue,a.props.audioContext.currentTime+.1)}))}},{key:"getColors",value:function(){return"audio"===this.props.type?["var(--secondary1-shade0)","var(--secondary1-shade1)","var(--secondary1-shade2)","var(--secondary1-shade3)","var(--secondary1-shade4)","var(--secondary1-shade5)"]:"control"===this.props.type?["var(--secondary2-shade0)","var(--secondary2-shade1)","var(--secondary2-shade2)","var(--secondary2-shade3)","var(--secondary2-shade4)","var(--secondary2-shade5)"]:void 0}}]),e}(),I=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).convertValueToDeg=function(e){return 270*e-135},n.handleMouseDown=function(e){e.preventDefault(),n.setState({dragging:!0})},n.handleMouseUp=function(e){e.preventDefault(),n.setState({dragging:!1})},n.handleMouseMove=function(e){if(e.preventDefault(),n.state.dragging){var t=n.state.boundingBox.current.getBoundingClientRect(),a=e.clientX-t.left,o=n.clampValue(1.2*a/t.width-.1);n.props.changeValue(o,n.props.target,n.props.value),n.props.readout(n.props.name,n.props.value)}},n.clampValue=function(e){return Math.max(0,Math.min(1,e))},n.handleMouseLeave=function(e){e.preventDefault(),n.state.dragging&&n.handleMouseUp(e)},n.state={dragging:!1,boundingBox:o.a.createRef()},n.vis={r:20},n.vis.width=4*n.vis.r,n.vis.height=3.5*n.vis.r,n.vis.cx=(n.vis.width-n.vis.r/2)/2,n.vis.cy=(n.vis.height-.8*n.vis.r)/2,n.touchRange=4*n.vis.r,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("mouseleave",this.handleMouseLeave)}},{key:"render",value:function(){var e=this.props.name,t=this.vis,n=t.cx,a=t.cy,i=t.r,r=t.width,s=t.height,l="rotate("+this.convertValueToDeg(this.props.value.relValue)+" "+n+" "+a+")",c=P.getColors.bind(this)();return o.a.createElement("svg",{style:{position:"relative",cursor:this.state.dragging?"pointer":"default"},width:r,height:s,ref:this.state.boundingBox},o.a.createElement("g",{onMouseDown:this.handleMouseDown,transform:l,style:{cursor:"pointer"}},o.a.createElement("circle",{cx:n,cy:a,r:i,fill:c[1]}),o.a.createElement("ellipse",{cx:n,cy:a-10,rx:.4*i,ry:.5*i,fill:c[3]})),o.a.createElement("text",{x:n-4*e.length,y:s-4,style:{font:"regular 12px sans-serif",fill:"#fff",cursor:"default"}},e))}}]),t}(o.a.Component),T=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).initParams=function(){n.dsp.osc.frequency.value=n.state.frequency,n.dsp.gain.gain.value=0},n.togglePlay=function(){n.state.isPlaying?(n.setState({isPlaying:!n.state.isPlaying}),n.dsp.gain.gain.value=0):(n.setState({isPlaying:!n.state.isPlaying}),n.dsp.gain.gain.value=n.state.gain)},n.changeFrequency=function(e){var t=n.dsp.osc,a=e.target.value;n.setState({frequency:a},(function(){t.frequency.value=a}))},n.changeGain=function(e){var t=n.dsp.gain,a=e.target.value;n.setState({gain:a},(function(){t.gain.value=a}))},n.name="BaseNode"+n.props.id,n.dsp={osc:n.props.audioContext.createOscillator(),gain:n.props.audioContext.createGain()},n.boundaries={minFrequency:20,minGain:0,maxFrequency:2e3,maxGain:1},n.state={isPlaying:!1,frequency:440,gain:.5},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.dsp,t=e.osc,n=e.gain;this.initParams(),t.connect(n),t.start(),this.props.rebuildLineComponents()}},{key:"componentWillUnmount",value:function(){this.dsp.osc.stop(),this.props.rebuildLineComponents()}},{key:"render",value:function(){return o.a.createElement("div",{style:L,className:"BaseNode"},o.a.createElement("h1",null,this.name),o.a.createElement(I,{name:"Frequency",unit:"Hz",changeValue:this.changeFrequency,step:"0.1",value:this.state.frequency,min:this.boundaries.minFrequency,max:this.boundaries.maxFrequency}),o.a.createElement(I,{name:"Gain",unit:"",changeValue:this.changeGain,step:"0.1",value:this.state.gain,min:this.boundaries.minGain,max:this.boundaries.maxGain}),o.a.createElement("button",{onClick:this.togglePlay},this.state.isPlaying?"Stop":"Start"),o.a.createElement(q,{type:"audio-output",id:this.name+"_audio-output-1",audioNode:this.dsp.gain,select:this.props.select}),o.a.createElement("button",{onClick:this.props.deleteNode.bind(this,this.name)},"[X]"))}}]),t}(o.a.Component),L={width:"200px",height:"350px",float:"left",backgroundColor:"var(--secondary1-shade0)",padding:"16px",border:"8px solid",borderColor:"var(--secondary1-shade3)"},D=T,H=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleClick=function(e){e.preventDefault();var t=(n.state.waveformIndex+1)%n.waveforms.length;n.setState((function(e,a){return n.props.changeWaveform(n.waveforms[t]),{waveformIndex:t}}))},n.displayWaveform=function(){return{sine:o.a.createElement("path",{fill:"none",stroke:"#fff",strokeWidth:1.5,d:" M -32,0 Q -16,-32 0,0 M 0,0 Q 16,32 32,0 "}),triangle:o.a.createElement("path",{fill:"none",stroke:"#fff",strokeWidth:1.5,d:" M -32,0 L -16,-16 M -16,-16 L 0,0 M 0,0 L 16,16 M 16,16 L 32,0 "}),square:o.a.createElement("path",{fill:"none",stroke:"#fff",strokeWidth:1.5,d:" M -24,-16 L 0,-16 M 0,-16 L 0,16 M 0,16 L 24,16 "}),sawtooth:o.a.createElement("path",{fill:"none",stroke:"#fff",strokeWidth:1.5,d:" M -24,0 L -24,-16 M -24,-16 L 24,16 M 24,16 L 24,0 "})}[n.waveforms[n.state.waveformIndex]]},n.getColors=function(){return"audio"===n.props.type?["var(--secondary1-shade0)","var(--secondary1-shade1)","var(--secondary1-shade2)","var(--secondary1-shade3)","var(--secondary1-shade4)","var(--secondary1-shade5)"]:"control"===n.props.type?["var(--secondary2-shade0)","var(--secondary2-shade1)","var(--secondary2-shade2)","var(--secondary2-shade3)","var(--secondary2-shade4)","var(--secondary2-shade5)"]:void 0},n.state={waveformIndex:0},n.waveforms=["sine","triangle","square","sawtooth"],n.vis={r:32,colors:n.getColors()},n.vis.width=2*n.vis.r,n.vis.height=2.5*n.vis.r,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.vis,t=e.width,n=e.height,a=e.r,i=e.colors;return o.a.createElement("div",{id:"WaveformSelector"},o.a.createElement("svg",{width:t,height:n,onClick:this.handleClick},o.a.createElement("g",{transform:"translate(x y)".replace("x",t/2).replace("y",n/2),style:{cursor:"pointer"}},o.a.createElement("circle",{style:{fill:i[1]},r:a}),this.displayWaveform())))}}]),t}(o.a.Component),M=function(){function e(t,n,a,o){var i=this;Object(s.a)(this,e),this.fromRelToAbs=function(e){return(i.max-i.min)*e+i.min},this.fromAbsToRel=function(e){return(e-i.min)/(i.max-i.min)},this.tag=t,this.min=a,this.max=o,this._relValue=this.fromAbsToRel(n),this._absValue=n}return Object(l.a)(e,[{key:"relValue",set:function(e){this._relValue=e,this._absValue=this.fromRelToAbs(e)},get:function(){return this._relValue}},{key:"absValue",set:function(e){this._absValue=e,this._relValue=this.fromAbsToRel(e)},get:function(){return this._absValue}}]),e}(),W=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleClick=function(e){n.props.onClick(),e.preventDefault()},n.displayIcon=function(){var e=n.vis,t=e.height,a=e.width,i=e.dim,r=e.strokeWidth,s=e.colors,l=a/2,c=t/2,u=(2.2-1.5)*i;return o.a.createElement("polygon",{points:[l-u,c-u]+" "+[l-u+r/2,c-u]+" "+[l,c-r/3]+" "+[l+u-r/2,c-u]+" "+[l+u,c-u]+" "+[l+r/3,c]+" "+[l+u,c+u]+" "+[l+u-r/2,c+u]+" "+[l,c+r/3]+" "+[l-u+r/2,c+u]+" "+[l-u,c+u]+" "+[l-u,c+u]+" "+[l-r/3,c],fill:s[4],stroke:s[4],strokeWidth:r/4})},n.vis={dim:12,colors:P.getColors.bind(Object(C.a)(n))()},n.vis.strokeWidth=n.vis.dim/3*1.5,n.vis.boundary=n.vis.dim+n.vis.strokeWidth,n.vis.height=3*n.vis.dim,n.vis.width=3*n.vis.dim,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.vis,t=e.height,n=e.width,a=e.dim,i=e.strokeWidth,r=e.colors;return o.a.createElement("div",{onClick:this.handleClick},o.a.createElement("svg",{height:t,width:n,style:{cursor:"pointer"}},o.a.createElement("g",null,o.a.createElement("circle",{cx:n/2,cy:t/2,r:a,stroke:r[1],strokeWidth:i,fill:r[1]}),this.displayIcon())))}}]),t}(o.a.Component),F=n(9),A=n.n(F),_=n(1),U=[8.1757989156,8.661957218,9.1770239974,9.7227182413,10.3008611535,10.9133822323,11.5623257097,12.2498573744,12.9782717994,13.75,14.5676175474,15.4338531643,16.351597831287414,17.323914436054505,18.354047994837977,19.445436482630058,20.601722307054366,21.826764464562746,23.12465141947715,24.499714748859326,25.956543598746574,27.5,29.13523509488062,30.86770632850775,32.70319566257483,34.64782887210901,36.70809598967594,38.890872965260115,41.20344461410875,43.653528929125486,46.2493028389543,48.999429497718666,51.91308719749314,55,58.27047018976124,61.7354126570155,65.40639132514966,69.29565774421802,73.41619197935188,77.78174593052023,82.4068892282175,87.30705785825097,92.4986056779086,97.99885899543733,103.82617439498628,110,116.54094037952248,123.47082531403103,130.8127826502993,138.59131548843604,146.8323839587038,155.56349186104046,164.81377845643496,174.61411571650194,184.9972113558172,195.99771799087463,207.65234878997256,220,233.08188075904496,246.94165062806206,261.6255653005986,277.1826309768721,293.6647679174076,311.1269837220809,329.6275569128699,349.2282314330039,369.9944227116344,391.99543598174927,415.3046975799451,440,466.1637615180899,493.8833012561241,523.2511306011972,554.3652619537442,587.3295358348151,622.2539674441618,659.2551138257398,698.4564628660078,739.9888454232688,783.9908719634985,830.6093951598903,880,932.3275230361799,987.7666025122483,1046.5022612023945,1108.7305239074883,1174.6590716696303,1244.5079348883237,1318.5102276514797,1396.9129257320155,1479.9776908465376,1567.981743926997,1661.2187903197805,1760,1864.6550460723597,1975.533205024496,2093.004522404789,2217.4610478149766,2349.31814333926,2489.0158697766,2637.02045530296,2793.825851464031,2959.955381693075,3135.9634878539946,3322.437580639561,3520,3729.3100921447194,3951.066410048992,4186.009044809578,4434.922095629953,4698.63628667852,4978.031739553295,5274.04091060592,5587.651702928062,5919.91076338615,6271.926975707989,6644.875161279122,7040,7458.620184289437,7902.132820097988,8372.018089619156,8869.844191259906,9397.272573357044,9956.06347910659,10548.081821211836,11175.303405856126,11839.8215267723,12543.853951415975],G=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).initParams=function(){n.dsp.osc.frequency.value=n.state.frequency.absValue},n.initInputs=function(){n.dsp.frequencyInput.gain.value=n.state.frequency.max,n.dsp.frequencyInput.connect(n.dsp.osc.frequency)},n.changeValue=P.changeValue.bind(Object(C.a)(n)),n.changeGain=function(e,t,a){var o=e,i=n.state[a.tag];i.relValue=o,n.setState(Object(p.a)({},a.tag,i),(function(){t.linearRampToValueAtTime(n.state[a.tag].absValue,n.props.audioContext.currentTime+.1)}))},n.changeWaveform=function(e){var t=n.dsp.osc;n.setState({waveform:e},(function(){t.type=e}))},n.keysToNoteOffsetDict={a:0,w:1,s:2,e:3,d:4,f:5,t:6,g:7,y:8,h:9,u:10,j:11,k:12},n.keyHandlerComponents=[o.a.createElement(_.b,{keyEventName:_.a,keyValue:"a",onKeyHandle:n.keyPressHandler.bind(Object(C.a)(n)),key:"a"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"w",onKeyHandle:n.keyPressHandler.bind(Object(C.a)(n)),key:"w"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"s",onKeyHandle:n.keyPressHandler.bind(Object(C.a)(n)),key:"s"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"e",onKeyHandle:n.keyPressHandler.bind(Object(C.a)(n)),key:"e"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"d",onKeyHandle:n.keyPressHandler.bind(Object(C.a)(n)),key:"d"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"f",onKeyHandle:n.keyPressHandler.bind(Object(C.a)(n)),key:"f"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"t",onKeyHandle:n.keyPressHandler.bind(Object(C.a)(n)),key:"t"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"g",onKeyHandle:n.keyPressHandler.bind(Object(C.a)(n)),key:"g"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"y",onKeyHandle:n.keyPressHandler.bind(Object(C.a)(n)),key:"y"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"h",onKeyHandle:n.keyPressHandler.bind(Object(C.a)(n)),key:"h"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"u",onKeyHandle:n.keyPressHandler.bind(Object(C.a)(n)),key:"u"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"j",onKeyHandle:n.keyPressHandler.bind(Object(C.a)(n)),key:"j"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"k",onKeyHandle:n.keyPressHandler.bind(Object(C.a)(n)),key:"k"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"z",onKeyHandle:n.keyPressHandler.bind(Object(C.a)(n)),key:"k"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"x",onKeyHandle:n.keyPressHandler.bind(Object(C.a)(n)),key:"k"})],n.name="OscNode"+n.props.id,n.dsp={osc:n.props.audioContext.createOscillator(),gain:n.props.audioContext.createGain(),frequencyInput:n.props.audioContext.createGain()},n.minFreq=20,n.maxFreq=2e3,n.state={waveform:"sine",frequency:new M("frequency",440,n.minFreq,n.maxFreq),gain:new M("gain",.5,0,1)},n.inputs=[n.dsp.frequencyInput,n.dsp.gain.gain],n.outputs=[n.dsp.gain],n.octave=5,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.dsp,t=e.osc,n=e.gain;this.initParams(),t.connect(n),t.start(),this.initInputs(),this.props.rebuildLineComponents()}},{key:"componentWillUnmount",value:function(){this.dsp.osc.stop(),this.props.cleanUp(this.name),this.props.rebuildLineComponents()}},{key:"getFrequencyFromKey",value:function(e){var t,n=this.keysToNoteOffsetDict[e];return null!==n||void 0!==n?(t=12*this.octave+n,U[t]):null}},{key:"keyPressHandler",value:function(e){e.preventDefault();var t=this.getFrequencyFromKey(e.key);if(t){var n=(t-this.minFreq)/(this.maxFreq-this.minFreq);this.changeValue(n,this.dsp.osc.frequency,this.state.frequency)}else"z"===e.key?--this.octave:"x"===e.key&&++this.octave}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,Object(E.a)(this.keyHandlerComponents),o.a.createElement(A.a,{handle:".handle",onDrag:this.props.rebuildLineComponents},o.a.createElement("div",{style:B,className:"OscNode"},o.a.createElement("div",{className:"handle"},o.a.createElement("h1",{style:R},o.a.createElement("p",{style:{display:"inline",gridColumStart:1}},"OSC"),o.a.createElement(W,{style:{gridColumStart:2},onClick:this.props.deleteNode.bind(this,this.name),type:"audio"}))),o.a.createElement(H,{changeWaveform:this.changeWaveform,type:"audio"}),o.a.createElement(q,{type:"control-input",id:this.name+"_control-input-1",audioNode:this.dsp.frequencyInput,select:this.props.select,getSelection:this.props.getSelection,coordinates:{x:-10,y:-4}}),o.a.createElement(I,{name:"Frequency",unit:"Hz",type:"audio",changeValue:this.changeValue,target:this.dsp.osc.frequency,value:this.state.frequency,readout:this.props.readout}),o.a.createElement("br",null),o.a.createElement(q,{type:"control-input",id:this.name+"_control-input-2",audioNode:this.dsp.gain.gain,select:this.props.select,getSelection:this.props.getSelection,coordinates:{x:-10,y:-4}}),o.a.createElement(I,{name:"Gain",unit:"",type:"audio",changeValue:this.changeGain,target:this.dsp.gain.gain,value:this.state.gain,readout:this.props.readout}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement(q,{type:"audio-output",id:this.name+"_audio-output-1",audioNode:this.dsp.gain,select:this.props.select,getSelection:this.props.getSelection,coordinates:{x:70,y:-20}}))))}}]),t}(o.a.Component),B={width:"200px",height:"350px",position:"absolute",left:"10vw",top:"20vh",backgroundColor:"var(--secondary1-shade0)"},R={display:"grid",gridTemplateColumns:"70% auto",width:"100%",height:"64px",flexDirection:"row",alignContent:"center",alignItems:"center",justifyContent:"center",color:"#fff",margin:"0px",padding:"0px",backgroundColor:"var(--secondary1-shade3)",cursor:"move"},K=G,Q=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).name="OutputNode",n.dsp={gain:n.props.audioContext.createGain()},n.state={gain:new M("gain",.5,0,1)},n.boundingBox=o.a.createRef(),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.dsp.gain.gain.value=this.state.gain.absValue,this.dsp.gain.connect(this.props.audioContext.destination)}},{key:"render",value:function(){return o.a.createElement(A.a,{handle:".handle",onDrag:this.props.rebuildLineComponents},o.a.createElement("div",{style:z},o.a.createElement("div",{className:"handle"},o.a.createElement("h1",{style:X},"OUT")),o.a.createElement(q,{type:"audio-input",id:this.name+"_audio-input-1",audioNode:this.dsp.gain,select:this.props.select,getSelection:this.props.getSelection,coordinates:{x:0,y:0}}),o.a.createElement(I,{name:"Gain",unit:"",type:"audio",changeValue:P.changeValue.bind(this),readout:this.props.readout,target:this.dsp.gain.gain,value:this.state.gain}),o.a.createElement("br",null)))}}]),t}(o.a.Component),z={width:"170px",height:"150px",position:"absolute",right:"5vw",bottom:"10vh",backgroundColor:"var(--secondary1-shade0)",touchAction:"none"},X={display:"flex",width:"100%",height:"64px",flexDirection:"row",alignItems:"center",justifyContent:"center",color:"#fff",margin:"0px",padding:"0px",backgroundColor:"var(--secondary1-shade3)",cursor:"move"},J=Q,Y=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).initParams=function(){n.dsp.gain.gain.value=n.state.gain.absValue},n.name="GainNode"+n.props.id,n.dsp={gain:n.props.audioContext.createGain()},n.state={gain:new M("gain",.5,0,1)},n.inputs=[n.dsp.gain],n.outputs=[n.dsp.gain],n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.initParams(),this.props.rebuildLineComponents()}},{key:"componentWillUnmount",value:function(){this.props.cleanUp(this.name),this.props.rebuildLineComponents()}},{key:"render",value:function(){return o.a.createElement(A.a,{handle:".handle",onDrag:this.props.rebuildLineComponents},o.a.createElement("div",{style:$,className:"GainNode"},o.a.createElement("div",{className:"handle"},o.a.createElement("h1",{style:Z},o.a.createElement("p",{style:{display:"inline"}},"GAIN"),o.a.createElement(W,{onClick:this.props.deleteNode.bind(this,this.name),type:"audio"}))),o.a.createElement(q,{type:"audio-input",id:this.name+"_audio-input-1",audioNode:this.dsp.gain,select:this.props.select,getSelection:this.props.getSelection,coordinates:{x:0,y:-4}}),o.a.createElement(I,{name:"Gain",unit:"",type:"audio",changeValue:P.changeValue.bind(this),target:this.dsp.gain.gain,value:this.state.gain,readout:this.props.readout}),o.a.createElement(q,{type:"audio-output",id:this.name+"_audio-output-1",audioNode:this.dsp.gain,select:this.props.select,getSelection:this.props.getSelection,coordinates:{x:0,y:-4}})))}}]),t}(o.a.Component),$={width:"180px",height:"150px",position:"absolute",left:"10vw",top:"20vh",backgroundColor:"var(--secondary1-shade0)"},Z={display:"grid",gridTemplateColumns:"70% auto",width:"100%",height:"64px",flexDirection:"row",alignContent:"center",alignItems:"center",justifyContent:"center",color:"#fff",margin:"0px",padding:"0px",backgroundColor:"var(--secondary1-shade3)",cursor:"move"},ee=Y,te=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleClick=function(e){e.preventDefault();var t=(n.state.profileIndex+1)%n.profiles.length;n.setState((function(e,a){return n.props.changeProfile(n.profiles[t]),{profileIndex:t}}))},n.displayProfile=function(){return{lowpass:o.a.createElement("path",{fill:"none",stroke:"#fff",strokeWidth:1.5,d:" M -30,-8 Q 0,-8 0,-8 M 0,-8 Q 16,-8 28,16 "}),highpass:o.a.createElement("path",{fill:"none",stroke:"#fff",strokeWidth:1.5,d:" M -30,8 Q -16,-8 0,-8 M 0,-8 Q 16,-8 28,-8 "}),bandpass:o.a.createElement("path",{fill:"none",stroke:"#fff",strokeWidth:1.5,d:" M -30,8 Q -16,-8 0,-8 M 0,-8 Q 16,-8 30,8 "}),notch:o.a.createElement("path",{fill:"none",stroke:"#fff",strokeWidth:1.5,d:" M -32,0 Q 0,0 0,32 M 0,32 Q 0,0 32,0 "}),allpass:o.a.createElement("path",{fill:"none",stroke:"#fff",strokeWidth:1.5,d:" M -32,0 Q -16,32 0,0 M 0,0 Q 16,-32 32,0 "})}[n.profiles[n.state.profileIndex]]},n.getColors=function(){return"audio"===n.props.type?["var(--secondary1-shade0)","var(--secondary1-shade1)","var(--secondary1-shade2)","var(--secondary1-shade3)","var(--secondary1-shade4)","var(--secondary1-shade5)"]:"control"===n.props.type?["var(--secondary2-shade0)","var(--secondary2-shade1)","var(--secondary2-shade2)","var(--secondary2-shade3)","var(--secondary2-shade4)","var(--secondary2-shade5)"]:void 0},n.state={profileIndex:0},n.profiles=["lowpass","highpass","bandpass"],n.vis={r:32,colors:n.getColors()},n.vis.width=2*n.vis.r,n.vis.height=2.5*n.vis.r,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.vis,t=e.width,n=e.height,a=e.r,i=e.colors;return o.a.createElement("div",{id:"profileselector"},o.a.createElement("svg",{width:t,height:n,onClick:this.handleClick},o.a.createElement("g",{transform:"translate(x y)".replace("x",t/2).replace("y",n/2),style:{cursor:"pointer"}},o.a.createElement("circle",{style:{fill:i[1]},r:a}),this.displayProfile())))}}]),t}(o.a.Component),ne=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).initParams=function(){n.dsp.filter.frequency.value=n.state.frequency.absValue,n.dsp.filter.Q.value=n.state.Q.absValue},n.initInputs=function(){n.dsp.frequencyInput.gain.value=n.state.frequency.max,n.dsp.frequencyInput.connect(n.dsp.filter.frequency),n.dsp.qInput.gain.value=n.state.Q.max,n.dsp.qInput.connect(n.dsp.filter.Q)},n.changeProfile=function(e){var t=n.dsp.filter;n.setState({waveform:e},(function(){t.type=e}))},n.name="FilterNode"+n.props.id,n.dsp={filter:n.props.audioContext.createBiquadFilter(),frequencyInput:n.props.audioContext.createGain(),qInput:n.props.audioContext.createGain()},n.state={frequency:new M("frequency",2e3,10,2e4),Q:new M("Q",0,1e-4,10),type:"lowpass"},n.inputs=[n.dsp.frequencyInput,n.dsp.qInput,n.dsp.filter],n.outputs=[n.dsp.filter],n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.initParams(),this.initInputs(),this.props.rebuildLineComponents()}},{key:"componentWillUnmount",value:function(){this.props.cleanUp(this.name),this.props.rebuildLineComponents()}},{key:"render",value:function(){return o.a.createElement(A.a,{handle:".handle",onDrag:this.props.rebuildLineComponents},o.a.createElement("div",{style:ae,className:"FilterNode"},o.a.createElement("div",{className:"handle"},o.a.createElement("h1",{style:oe},o.a.createElement("p",{style:{display:"inline"}},"FLT"),o.a.createElement(W,{type:"audio",onClick:this.props.deleteNode.bind(this,this.name)}))),o.a.createElement(te,{changeProfile:this.changeProfile,type:"audio"}),o.a.createElement(q,{type:"control-input",id:this.name+"_control-input-1",audioNode:this.dsp.frequencyInput,select:this.props.select,getSelection:this.props.getSelection,coordinates:{x:-20,y:-4}}),o.a.createElement(I,{name:"Frequency",unit:"Hz",type:"audio",changeValue:P.changeValue.bind(this),target:this.dsp.filter.frequency,value:this.state.frequency,readout:this.props.readout}),o.a.createElement("br",null),o.a.createElement(q,{type:"control-input",id:this.name+"_control-input-2",audioNode:this.dsp.qInput,select:this.props.select,getSelection:this.props.getSelection,coordinates:{x:-20,y:-4}}),o.a.createElement(I,{name:"Q",unit:"",type:"audio",changeValue:P.changeValue.bind(this),target:this.dsp.filter.Q,value:this.state.Q,readout:this.props.readout}),o.a.createElement("br",null),o.a.createElement(q,{type:"audio-input",id:this.name+"_audio-input-1",audioNode:this.dsp.filter,select:this.props.select,getSelection:this.props.getSelection,coordinates:{x:-35,y:0}}),o.a.createElement(q,{type:"audio-output",id:this.name+"_audio-output-1",audioNode:this.dsp.filter,select:this.props.select,getSelection:this.props.getSelection,coordinates:{x:30,y:0}})))}}]),t}(o.a.Component),ae={width:"180px",height:"350px",position:"absolute",left:"10vw",top:"20vh",backgroundColor:"var(--secondary1-shade0)"},oe={display:"grid",gridTemplateColumns:"70% auto",width:"100%",height:"64px",flexDirection:"row",alignContent:"center",alignItems:"center",justifyContent:"center",color:"#fff",margin:"0px",padding:"0px",backgroundColor:"var(--secondary1-shade3)",cursor:"move"},ie=ne,re=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).initParams=function(){n.dsp.osc.frequency.value=n.state.frequency.absValue},n.initInputs=function(){n.dsp.frequencyInput.gain.value=n.state.gain.max,n.dsp.frequencyInput.connect(n.dsp.osc.frequency)},n.changeWaveform=function(e){var t=n.dsp.osc;n.setState({waveform:e},(function(){t.type=e}))},n.changeGain=function(e,t,a){var o=e,i=n.state[a.tag];i.relValue=o,n.setState(Object(p.a)({},a.tag,i),(function(){t.linearRampToValueAtTime(n.state[a.tag].absValue,n.props.audioContext.currentTime+.1)}))},n.name="LFONode"+n.props.id,n.dsp={osc:n.props.audioContext.createOscillator(),gain:n.props.audioContext.createGain(),frequencyInput:n.props.audioContext.createGain()},n.state={waveform:"sine",frequency:new M("frequency",5,.001,20),gain:new M("gain",.5,0,1)},n.inputs=[n.dsp.frequencyInput,n.dsp.gain.gain],n.outputs=[n.dsp.gain],n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.dsp,t=e.osc,n=e.gain;this.initParams(),t.connect(n),t.start(),this.initInputs(),this.props.rebuildLineComponents()}},{key:"componentWillUnmount",value:function(){this.dsp.osc.stop(),this.props.cleanUp(this.name),this.props.rebuildLineComponents()}},{key:"render",value:function(){return o.a.createElement(A.a,{handle:".handle",onDrag:this.props.rebuildLineComponents},o.a.createElement("div",{style:se,className:"LFONode"},o.a.createElement("div",{className:"handle"},o.a.createElement("h1",{style:le},o.a.createElement("p",{style:{display:"inline",gridColumStart:1}},"LFO"),o.a.createElement(W,{style:{gridColumStart:2},onClick:this.props.deleteNode.bind(this,this.name),type:"control"}))),o.a.createElement(H,{changeWaveform:this.changeWaveform,type:"control"}),o.a.createElement(q,{type:"control-input",id:this.name+"_control-input-1",audioNode:this.dsp.frequencyInput,select:this.props.select,getSelection:this.props.getSelection,coordinates:{x:-10,y:-4}}),o.a.createElement(I,{name:"Frequency",unit:"Hz",type:"control",changeValue:P.changeValue.bind(this),target:this.dsp.osc.frequency,value:this.state.frequency,readout:this.props.readout}),o.a.createElement("br",null),o.a.createElement(q,{type:"control-input",id:this.name+"_control-input-2",audioNode:this.dsp.gain.gain,select:this.props.select,getSelection:this.props.getSelection,coordinates:{x:-10,y:-4}}),o.a.createElement(I,{name:"Gain",unit:"",type:"control",changeValue:this.changeGain,target:this.dsp.gain.gain,value:this.state.gain,readout:this.props.readout}),o.a.createElement("br",null),o.a.createElement(q,{type:"control-output",id:this.name+"_control-output-1",audioNode:this.dsp.gain,select:this.props.select,getSelection:this.props.getSelection,coordinates:{x:68,y:-3}})))}}]),t}(o.a.Component),se={width:"200px",height:"350px",position:"absolute",left:"10vw",top:"20vh",backgroundColor:"var(--secondary2-shade0)"},le={display:"grid",gridTemplateColumns:"70% auto",width:"100%",height:"64px",flexDirection:"row",alignContent:"center",alignItems:"center",justifyContent:"center",color:"#fff",margin:"0px",padding:"0px",backgroundColor:"var(--secondary2-shade3)",cursor:"move"},ce=re,ue=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleClick=function(e){e.preventDefault(),n.setState({isPlaying:!n.state.isPlaying}),n.props.onClick()},n.getStartIcon=function(){var e=n.vis,t=e.height,a=e.width,i=e.dim,r=e.colors,s=a/2,l=t/2;return o.a.createElement("polygon",{points:[s+.8*i,l]+", "+[s-i/2,l+.8*i]+", "+[s-i/2,l-.8*i],fill:r[4]})},n.getStopIcon=function(){var e=n.vis,t=e.height,a=e.width,i=e.dim,r=e.colors,s=a/2,l=t/2;return o.a.createElement("rect",{x:s-i/2*1.3,y:l-i/2*1.3,width:1.3*i,height:1.3*i,fill:r[4]})},n.displayIcon=function(){return n.props.constant?n.getStartIcon():n.state.isPlaying?n.getStopIcon():n.getStartIcon()},n.state={isPlaying:!1},n.vis={dim:12,colors:P.getColors.bind(Object(C.a)(n))()},n.vis.strokeWidth=n.vis.dim/3*2,n.vis.boundary=n.vis.dim+n.vis.strokeWidth,n.vis.height=3*n.vis.dim,n.vis.width=3*n.vis.dim,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.vis,t=e.height,n=e.width,a=e.dim,i=e.strokeWidth,r=e.colors;return o.a.createElement("svg",{height:t,width:n,style:{cursor:"pointer"}},o.a.createElement("g",{onClick:this.handleClick},o.a.createElement("circle",{cx:n/2,cy:t/2,r:a,stroke:r[1],strokeWidth:i,fill:r[1]}),this.displayIcon()))}}]),t}(o.a.Component),de=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).toggleIsPlaying=function(){n.setState({isPlaying:!n.state.isPlaying})},n.triggerEnvelope=function(){n.dsp.constantSource.offset.cancelScheduledValues(0),console.log("Playing env");var e=n.state.aLevel.absValue,t=n.dsp.constantSource,a=[n.props.audioContext.currentTime+n.state.attack.absValue,n.props.audioContext.currentTime+n.state.attack.absValue+n.state.decay.absValue,n.props.audioContext.currentTime+n.state.attack.absValue+n.state.decay.absValue+n.state.release.absValue];t.offset.linearRampToValueAtTime(e,a[0]),t.offset.linearRampToValueAtTime(n.state.sustain.absValue,a[1]),t.offset.linearRampToValueAtTime(0,a[2])},n.changeValue=function(e,t,a){var o=n.state[a.tag];o.relValue=e,n.setState(Object(p.a)({},a.tag,o),(function(){}))},n.keyHandlerComponents=[o.a.createElement(_.b,{keyEventName:_.a,keyValue:"a",onKeyHandle:n.triggerEnvelope,key:"a"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"w",onKeyHandle:n.triggerEnvelope,key:"w"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"s",onKeyHandle:n.triggerEnvelope,key:"s"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"e",onKeyHandle:n.triggerEnvelope,key:"e"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"d",onKeyHandle:n.triggerEnvelope,key:"d"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"f",onKeyHandle:n.triggerEnvelope,key:"f"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"t",onKeyHandle:n.triggerEnvelope,key:"t"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"g",onKeyHandle:n.triggerEnvelope,key:"g"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"y",onKeyHandle:n.triggerEnvelope,key:"y"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"h",onKeyHandle:n.triggerEnvelope,key:"h"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"u",onKeyHandle:n.triggerEnvelope,key:"u"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"j",onKeyHandle:n.triggerEnvelope,key:"j"}),o.a.createElement(_.b,{keyEventName:_.a,keyValue:"k",onKeyHandle:n.triggerEnvelope,key:"k"})],n.name="EnvelopeNode"+n.props.id,n.dsp={constantSource:n.props.audioContext.createConstantSource()},n.state={isPlaying:!1,attack:new M("attack",.005,0,1),aLevel:new M("aLevel",1,0,1),decay:new M("decay",.626,0,1),sustain:new M("sustain",.5,0,1),release:new M("release",.5,0,1)},n.inputs=[],n.outputs=[n.dsp.constantSource],n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.dsp.constantSource;e.offset.value=0,e.start(),this.props.rebuildLineComponents()}},{key:"componentWillUnmount",value:function(){this.dsp.constantSource&&this.dsp.constantSource.stop(),this.props.cleanUp(this.name),this.props.rebuildLineComponents()}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,this.state.isPlaying&&Object(E.a)(this.keyHandlerComponents),o.a.createElement(A.a,{handle:".handle",onDrag:this.props.rebuildLineComponents},o.a.createElement("div",{style:pe,className:"EnvelopeNode"},o.a.createElement("div",{className:"handle"},o.a.createElement("h1",{style:he},o.a.createElement(ue,{onClick:this.toggleIsPlaying,constant:!0,type:"control"}),o.a.createElement("p",null,"ENV"),o.a.createElement(W,{onClick:this.props.deleteNode.bind(this,this.name),type:"control"}))),o.a.createElement(I,{name:"Attack",unit:"s",type:"control",changeValue:this.changeValue,target:"none",value:this.state.attack,readout:this.props.readout}),o.a.createElement(I,{name:"aLevel",unit:"",type:"control",changeValue:this.changeValue,target:"none",value:this.state.aLevel,readout:this.props.readout}),o.a.createElement(I,{name:"Decay",unit:"s",type:"control",changeValue:this.changeValue,target:"none",value:this.state.decay,readout:this.props.readout}),o.a.createElement(I,{name:"Sustain",unit:"",type:"control",changeValue:this.changeValue,target:"none",value:this.state.sustain,readout:this.props.readout}),o.a.createElement(I,{name:"Release",unit:"s",type:"control",changeValue:this.changeValue,target:"none",value:this.state.release,readout:this.props.readout}),o.a.createElement("br",null),o.a.createElement(q,{type:"control-output",id:this.name+"_control-output-1",audioNode:this.dsp.constantSource,select:this.props.select,getSelection:this.props.getSelection,coordinates:{x:95,y:-18}}))))}}]),t}(o.a.Component),pe={width:"250px",height:"250px",position:"absolute",left:"10vw",top:"20vh",backgroundColor:"var(--secondary2-shade0)"},he={display:"grid",gridTemplateColumns:"auto auto auto",width:"100%",height:"64px",flexDirection:"row",alignContent:"center",alignItems:"center",justifyContent:"space-evenly",color:"#fff",margin:"0px",padding:"0px",backgroundColor:"var(--secondary2-shade3)",cursor:"move"},me=de,ye=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).getButtons=function(){for(var e=Math.ceil(n.props.beats.absValue/8),t=[],a=["var(--secondary2-shade1)","var(--secondary2-shade3)"],i=0,r=n.props.beats.absValue;i<e;){for(var s=r>8?8:r,l=0;l<s;l++){var c=l>0?8:0,u=l+8*i;t.push(o.a.createElement("circle",{cx:14+(28+c)*l+10,cy:14+35*i,r:8,fill:a[0],stroke:n.props.active[u]?a[1]:a[0],strokeWidth:6,key:u.toString(),onClick:n.props.onClick.bind(Object(C.a)(n),u)}))}r-=8,i++}return o.a.createElement("svg",{display:"inline",onClick:n.props.onClick},t)},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,this.getButtons())}}]),t}(o.a.Component),ge=function(){function e(t,n,a,o){var i=this;Object(s.a)(this,e),this.fromRelToAbs=function(e){return Math.round((i.max-i.min)*e+i.min)},this.fromAbsToRel=function(e){return(e-i.min)/(i.max-i.min)},this.tag=t,this.min=a,this.max=o,this._relValue=this.fromAbsToRel(n),this._absValue=Math.round(n)}return Object(l.a)(e,[{key:"relValue",set:function(e){this._relValue=e,this._absValue=this.fromRelToAbs(e)},get:function(){return this._relValue}},{key:"absValue",set:function(e){this._absValue=Math.round(e),this._relValue=this.fromAbsToRel(e)},get:function(){return this._absValue}}]),e}(),fe=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).initializeActiveBeats=function(){for(var e=[],t=0;t<n.state.beats.absValue;t++)e.push(!1);n.setState({activeBeats:e})},n.nextNote=function(){var e=60/n.state.bpm.absValue;n.sequencer.nextNoteTime+=e,n.sequencer.currentNote++,n.sequencer.currentNote===n.state.beats.absValue&&(n.sequencer.currentNote=0)},n.scheduleNote=function(e,t){n.sequencer.notesInQueue.push({note:e,time:t}),n.state.activeBeats.find((function(e,t,a){return n.sequencer.currentNote===t&&e}))&&n.sendSignal()},n.scheduler=function(){for(;n.sequencer.nextNoteTime<n.props.audioContext.currentTime+n.sequencer.scheduleAheadTime;)n.scheduleNote(n.sequencer.currentNote,n.sequencer.nextNoteTime),n.nextNote();n.dequeueNotes(),n.timerID=window.setTimeout(n.scheduler,n.sequencer.lookahead)},n.dequeueNotes=function(){for(var e=n.props.audioContext.currentTime;n.sequencer.notesInQueue.length&&n.sequencer.notesInQueue[0].time<e;)n.sequencer.notesInQueue.splice(0,1)},n.sendSignal=function(){n.dsp.gate.offset.cancelScheduledValues(n.props.audioContext.currentTime),n.dsp.gate.offset.linearRampToValueAtTime(n.state.gain.absValue,n.props.audioContext.currentTime+n.internalEnvelope.a),n.dsp.gate.offset.linearRampToValueAtTime(n.state.gain.absValue,n.props.audioContext.currentTime+n.internalEnvelope.a+n.internalEnvelope.d),n.dsp.gate.offset.linearRampToValueAtTime(0,n.props.audioContext.currentTime+n.internalEnvelope.a+n.internalEnvelope.d+n.internalEnvelope.r)},n.togglePlay=function(){var e=n.state.isPlaying;n.setState({isPlaying:!e},(function(){e?window.clearTimeout(n.timerID):(n.sequencer.currentNote=0,n.sequencer.nextNoteTime=n.props.audioContext.currentTime,n.scheduler())}))},n.changeValue=function(e,t,a){var o=n.state[a.tag];o.relValue=e,n.setState(Object(p.a)({},a.tag,o),(function(){}))},n.changeBPM=function(e){var t=n.state.bpm;t.relValue=e,n.setState({bpm:t},(function(){}))},n.changeBeats=function(e){var t=n.state.beats;t.relValue=e,n.setState({beats:t},(function(){for(var e=n.state.activeBeats;e.length>n.state.beats.absValue;)e.pop();for(;e.length<n.state.beats.absValue;)e.push(!1)}))},n.renderSequencerButtons=function(){for(var e=n.state,t=e.beats,a=e.activeBeats,i=[],r=0;r<t.absValue;r++)i.push(o.a.createElement("button",{onClick:n.toggleBeat.bind(Object(C.a)(n),r),key:r.toString()},a[r]?"X":"O"));return i},n.toggleBeat=function(e){var t=n.state.activeBeats;t[e]=!t[e],n.setState({activeBeats:t})},n.name="SequencerNode"+n.props.id,n.dsp={gate:n.props.audioContext.createConstantSource()},n.state={isPlaying:!1,bpm:new ge("bpm",60,10,240),beats:new ge("beats",8,1,32),gain:new M("gain",1,0,1),activeBeats:[],beatOffsets:[]},n.sequencer={currentNote:0,nextNoteTime:0,lookahead:25,scheduleAheadTime:.1,notesInQueue:[]},n.internalEnvelope={a:.1,d:.15,r:.1},n.timerID=null,n.inputs=[],n.outputs=[n.dsp.gate],n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.dsp.gate;e.offset.setValueAtTime(0,this.props.audioContext.currentTime),e.start(),this.initializeActiveBeats(),this.props.rebuildLineComponents()}},{key:"componentWillUnmount",value:function(){this.dsp.gate.stop(),this.props.cleanUp(this.name),this.props.rebuildLineComponents()}},{key:"render",value:function(){return o.a.createElement(A.a,{handle:".handle",onDrag:this.props.rebuildLineComponents},o.a.createElement("div",{style:ve,className:"SequencerNode"},o.a.createElement("div",{className:"handle"},o.a.createElement("h1",{style:be},o.a.createElement(ue,{style:{gridColumStart:1},onClick:this.togglePlay,isPlaying:this.state.isPlaying,type:"control"}),o.a.createElement("p",{style:{display:"inline",gridColumStart:2}},"SEQ"),o.a.createElement(W,{style:{gridColumStart:3},onClick:this.props.deleteNode.bind(this,this.name),type:"control"}))),o.a.createElement(I,{name:"BPM",unit:"",type:"control",changeValue:this.changeBPM,value:this.state.bpm,readout:this.props.readout}),o.a.createElement(I,{name:"Beats",unit:"",type:"control",changeValue:this.changeBeats,value:this.state.beats,readout:this.props.readout}),o.a.createElement(I,{name:"Gain",unit:"",type:"control",changeValue:this.changeValue,target:"none",value:this.state.gain,readout:this.props.readout}),o.a.createElement(ye,{onClick:this.toggleBeat,active:this.state.activeBeats,beats:this.state.beats}),o.a.createElement("br",null),o.a.createElement(q,{type:"control-output",id:this.name+"_control-output-1",audioNode:this.dsp.gate,select:this.props.select,getSelection:this.props.getSelection,coordinates:{x:115,y:-20}})))}}]),t}(o.a.Component),ve={width:"300px",height:"350px",position:"absolute",left:"10vw",top:"20vh",backgroundColor:"var(--secondary2-shade0)"},be={display:"grid",gridTemplateColumns:"auto auto auto",width:"100%",height:"64px",flexDirection:"row",alignContent:"center",alignItems:"center",justifyContent:"space-evenly",color:"#fff",margin:"0px",padding:"0px",backgroundColor:"var(--secondary2-shade3)",cursor:"move"},ke=fe,Ee=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).initParams=function(){n.dsp.osc.frequency.value=n.state.frequency.absValue},n.initInputs=function(){n.dsp.frequencyInput.gain.value=n.state.gain.max,n.dsp.frequencyInput.connect(n.dsp.osc.frequency)},n.changeWaveform=function(e){var t=n.dsp.osc;n.setState({waveform:e},(function(){t.type=e}))},n.changeGain=function(e,t,a){var o=e,i=n.state[a.tag];i.relValue=o,n.setState(Object(p.a)({},a.tag,i),(function(){t.linearRampToValueAtTime(n.state[a.tag].absValue,n.props.audioContext.currentTime+.1)}))},n.name="FMNode"+n.props.id,n.dsp={osc:n.props.audioContext.createOscillator(),gain:n.props.audioContext.createGain(),frequencyInput:n.props.audioContext.createGain()},n.state={waveform:"sine",frequency:new M("frequency",5,.001,1e3),gain:new M("gain",.5,0,1)},n.inputs=[n.dsp.frequencyInput,n.dsp.gain.gain],n.outputs=[n.dsp.gain],n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.dsp,t=e.osc,n=e.gain;this.initParams(),t.connect(n),t.start(),this.initInputs(),this.props.rebuildLineComponents()}},{key:"componentWillUnmount",value:function(){this.dsp.osc.stop(),this.props.cleanUp(this.name),this.props.rebuildLineComponents()}},{key:"render",value:function(){return o.a.createElement(A.a,{handle:".handle",onDrag:this.props.rebuildLineComponents},o.a.createElement("div",{style:Ce,className:"FMNode"},o.a.createElement("div",{className:"handle"},o.a.createElement("h1",{style:xe},o.a.createElement("p",{style:{display:"inline",gridColumStart:1}},"FM"),o.a.createElement(W,{style:{gridColumStart:2},onClick:this.props.deleteNode.bind(this,this.name),type:"control"}))),o.a.createElement(H,{changeWaveform:this.changeWaveform,type:"control"}),o.a.createElement(q,{type:"control-input",id:this.name+"_control-input-1",audioNode:this.dsp.frequencyInput,select:this.props.select,getSelection:this.props.getSelection,coordinates:{x:-10,y:-4}}),o.a.createElement(I,{name:"Frequency",unit:"Hz",type:"control",changeValue:P.changeValue.bind(this),target:this.dsp.osc.frequency,value:this.state.frequency,readout:this.props.readout}),o.a.createElement("br",null),o.a.createElement(q,{type:"control-input",id:this.name+"_control-input-2",audioNode:this.dsp.gain.gain,select:this.props.select,getSelection:this.props.getSelection,coordinates:{x:-10,y:-4}}),o.a.createElement(I,{name:"Gain",unit:"",type:"control",changeValue:this.changeGain,target:this.dsp.gain.gain,value:this.state.gain,readout:this.props.readout}),o.a.createElement("br",null),o.a.createElement(q,{type:"control-output",id:this.name+"_control-output-1",audioNode:this.dsp.gain,select:this.props.select,getSelection:this.props.getSelection,coordinates:{x:68,y:-3}})))}}]),t}(o.a.Component),Ce={width:"200px",height:"350px",position:"absolute",left:"10vw",top:"20vh",backgroundColor:"var(--secondary2-shade0)"},xe={display:"grid",gridTemplateColumns:"70% auto",width:"100%",height:"64px",flexDirection:"row",alignContent:"center",alignItems:"center",justifyContent:"center",color:"#fff",margin:"0px",padding:"0px",backgroundColor:"var(--secondary2-shade3)",cursor:"move"},Oe=Ee,je=n(17),Ne=n.n(je);function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var we=function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).getNextFreeId=function(e){var t=n.state.nodes.filter((function(t){return t.type.name===e}));t.sort((function(e,t){return e.props.id-t.props.id}));for(var a=0;a<t.length;a++)if(t[a].props.id>a)return 0===a?0:t[a-1].props.id+1;return t.length},n.getSelection=function(){return n.state.selection},n.createNode=function(e){var t,a=n.getNextFreeId(e);switch(e){case"BaseNode":t=o.a.createElement(D,{id:a,key:e+"_"+a,audioContext:n.state.audioContext,select:n.select,deleteNode:n.deleteNode,cleanUp:n.cleanUp,getSelection:n.getSelection,rebuildLineComponents:n.rebuildLineComponents.bind(Object(C.a)(n)),readout:n.readout});break;case"OscNode":t=o.a.createElement(K,{id:a,key:e+"_"+a,audioContext:n.state.audioContext,select:n.select,deleteNode:n.deleteNode,cleanUp:n.cleanUp,getSelection:n.getSelection,rebuildLineComponents:n.rebuildLineComponents.bind(Object(C.a)(n)),readout:n.readout});break;case"GainNode":t=o.a.createElement(ee,{id:a,key:e+"_"+a,audioContext:n.state.audioContext,select:n.select,deleteNode:n.deleteNode,cleanUp:n.cleanUp,getSelection:n.getSelection,rebuildLineComponents:n.rebuildLineComponents.bind(Object(C.a)(n)),readout:n.readout});break;case"FilterNode":t=o.a.createElement(ie,{id:a,key:e+"_"+a,audioContext:n.state.audioContext,select:n.select,deleteNode:n.deleteNode,cleanUp:n.cleanUp,getSelection:n.getSelection,rebuildLineComponents:n.rebuildLineComponents.bind(Object(C.a)(n)),readout:n.readout});break;case"LFONode":t=o.a.createElement(ce,{id:a,key:e+"_"+a,audioContext:n.state.audioContext,select:n.select,deleteNode:n.deleteNode,cleanUp:n.cleanUp,getSelection:n.getSelection,rebuildLineComponents:n.rebuildLineComponents.bind(Object(C.a)(n)),readout:n.readout});break;case"EnvelopeNode":t=o.a.createElement(me,{id:a,key:e+"_"+a,audioContext:n.state.audioContext,select:n.select,deleteNode:n.deleteNode,cleanUp:n.cleanUp,getSelection:n.getSelection,rebuildLineComponents:n.rebuildLineComponents.bind(Object(C.a)(n)),readout:n.readout});break;case"SequencerNode":t=o.a.createElement(ke,{id:a,key:e+"_"+a,audioContext:n.state.audioContext,select:n.select,deleteNode:n.deleteNode,cleanUp:n.cleanUp,getSelection:n.getSelection,rebuildLineComponents:n.rebuildLineComponents.bind(Object(C.a)(n)),readout:n.readout});break;case"FMNode":t=o.a.createElement(Oe,{id:a,key:e+"_"+a,audioContext:n.state.audioContext,select:n.select,deleteNode:n.deleteNode,cleanUp:n.cleanUp,getSelection:n.getSelection,rebuildLineComponents:n.rebuildLineComponents.bind(Object(C.a)(n)),readout:n.readout})}n.setState({nodes:[].concat(Object(E.a)(n.state.nodes),[t])})},n.deleteNode=function(e){var t=n.state.nodes.filter((function(t){return t.type.name+t.props.id!==e}));n.setState({nodes:Object(E.a)(t)})},n.getUpdatedSelection=function(e,t){var a=Object(E.a)(n.state.selection);return a[e]=t,a},n.storeConnection=function(e,t){var a;"audio-output"===e.type&&"audio-input"===t.type?a="audio":"control-output"===e.type&&"control-input"===t.type&&(a="control");var o={type:a,output:e,input:t},i=n.buildLineComponentFromConnection(o);n.setState({existingConnections:[].concat(Object(E.a)(n.state.existingConnections),[o]),lineComponents:[].concat(Object(E.a)(n.state.lineComponents),[i])})},n.removeStoredConnection=function(e,t){var a=n.state.existingConnections.filter((function(n){return n.output.id!==e.id||n.input.id!==t.id})),o=n.state.lineComponents.filter((function(n){return n.props.from!==e.id||n.props.to!==t.id}));n.setState({existingConnections:Object(E.a)(a),lineComponents:Object(E.a)(o)})},n.connectionExists=function(e,t){return n.state.existingConnections.filter((function(n){return n.output.id===e.id&&n.input.id===t.id})).length>0},n.sortSelection=function(){var e=n.state.selection[0],t=n.state.selection[1];return{input:"audio-input"===e.type||"control-input"===e.type?e:t,output:"audio-output"===e.type||"control-output"===e.type?e:t}},n.isSelectionValidConnection=function(){var e=n.state.selection[0],t=n.state.selection[1],a=e.id.slice(0,e.id.indexOf("_")),o=t.id.slice(0,t.id.indexOf("_"));return("control-output"===e.type&&"control-input"===t.type||"control-input"===e.type&&"control-output"===t.type||"audio-output"===e.type&&"audio-input"===t.type||"audio-input"===e.type&&"audio-output"===t.type)&&a!==o},n.toggleConnection=function(){if(n.isSelectionValidConnection()){var e=n.sortSelection(),t=e.input,a=e.output;n.connectionExists(a,t)?(a.audioNode.disconnect(t.audioNode),n.removeStoredConnection(a,t)):(a.audioNode.connect(t.audioNode),n.storeConnection(a,t))}else alert("I can't make that connection. Only connections with an input and an output of the same type between different nodes are allowed.")},n.select=function(e,t,a){var o=Object(E.a)(n.state.selection);o.some((function(n,i,r){return null===n&&(o[i]={id:e,type:t,audioNode:a}),null===n})),n.setState({selection:o},(function(){null!==n.state.selection[0]&&null!==n.state.selection[1]&&(n.toggleConnection(),n.setState({selection:[null,null]}))}))},n.rebuildLineComponents=function(){this.setState({lineComponents:[]});var e=[],t=!0,n=!1,a=void 0;try{for(var o,i=this.state.existingConnections[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var r=o.value,s=this.buildLineComponentFromConnection(r);e=[].concat(Object(E.a)(e),[s])}}catch(l){n=!0,a=l}finally{try{t||null==i.return||i.return()}finally{if(n)throw a}}this.setState({lineComponents:e})},n.createNodeHandlers={OSC:n.createNode.bind(Object(C.a)(n),"OscNode"),GAIN:n.createNode.bind(Object(C.a)(n),"GainNode"),FILTER:n.createNode.bind(Object(C.a)(n),"FilterNode"),LFO:n.createNode.bind(Object(C.a)(n),"LFONode"),ENV:n.createNode.bind(Object(C.a)(n),"EnvelopeNode"),SEQ:n.createNode.bind(Object(C.a)(n),"SequencerNode"),FM:n.createNode.bind(Object(C.a)(n),"FMNode")},n.cleanUp=function(e){var t=!0,a=!1,o=void 0;try{for(var i,r=n.state.existingConnections[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=i.value;(s.input.id.startsWith(e)||s.output.id.startsWith(e))&&s.output.audioNode.disconnect(s.input.audioNode)}}catch(u){a=!0,o=u}finally{try{t||null==r.return||r.return()}finally{if(a)throw o}}var l=n.state.existingConnections.filter((function(t){return!(t.output.id.startsWith(e)||t.input.id.startsWith(e))})),c=n.state.lineComponents.filter((function(t){return!(t.props.from.startsWith(e)||t.props.to.startsWith(e))}));n.setState({existingConnections:l,lineComponents:c})},n.readout=function(e,t){clearTimeout(n.readoutState.timer),n.readoutState.text=e.concat(": ",Number(t.absValue).toPrecision(2)),n.readoutState.hidden=!1,n.readoutState.timer=setTimeout((function(){n.readoutState.text="",n.readoutState.hidden=!0,n.forceUpdate()}),n.readoutState.fadeTime),n.forceUpdate()};return n.state={audioContext:new AudioContext,nodes:[],selection:[null,null],existingConnections:[],lineComponents:[]},n.readoutState={timer:null,fadeTime:2e3,text:"",hidden:!0},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"getConnectionColor",value:function(e){var t;switch(e.type){case"audio":t="var(--secondary1-shade0)";break;case"control":t="var(--secondary2-shade0)";break;default:t="red"}return t}},{key:"buildLineComponentFromConnection",value:function(e){return o.a.createElement(Ne.a,Object.assign({className:"line",from:e.output.id,to:e.input.id,borderColor:this.getConnectionColor(e),key:e.output.id+"_"+e.input.id},qe))}},{key:"render",value:function(){var e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Se(n,!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Pe,{visibility:this.readoutState.hidden?"hidden":"visible"});return o.a.createElement("div",{className:"workspace",style:Ve,onScroll:this.rebuildLineComponents.bind(this)},o.a.createElement(V,{createNodeHandlers:this.createNodeHandlers}),this.state.nodes,o.a.createElement(J,{id:this.state.nodes.length,audioContext:this.state.audioContext,select:this.select,selection:this.state.selection,getSelection:this.getSelection,rebuildLineComponents:this.rebuildLineComponents.bind(this),readout:this.readout}),this.state.lineComponents,o.a.createElement("div",{className:"readout",style:e},this.readoutState.text))}}]),t}(o.a.Component),Ve={width:"100%",height:"100%",overflow:"auto",zIndex:"-10",position:"fixed",backgroundColor:"var(--primary-shade1)"},qe={borderStyle:"solid",borderWidth:5},Pe={position:"fixed",padding:"0.5em 2em",bottom:"24px",right:"4px",color:"#fff",backgroundColor:"var(--primary-shade2)"},Ie=we,Te=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).id="App",n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement(y,null),o.a.createElement(Ie,null),o.a.createElement(k,null))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(Te,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[18,1,2]]]);
//# sourceMappingURL=main.b6b942db.chunk.js.map